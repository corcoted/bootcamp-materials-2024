{
  "hash": "3fda77b47b5b49f9c07f91aef1337a56",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Bayes in STEM Fields: <br> Use Cases\"\nsubtitle: \"Day 2\"\nformat: \n  revealjs:\n    slide-number: true\n    incremental: true\n    theme: [\"../../templates/slides-style.scss\"]\n    logo: https://www.stat.uci.edu/bayes-bats/img/logo.png\n    title-slide-attributes: \n      data-background-image: https://www.stat.uci.edu/bayes-bats/img/logo.png\n      data-background-size: 12%\n      data-background-position: 50% 95%\n    include-after-body: ../../templates/clean_title_page.html\n---\n\n\n\n## Toxicological Testing: Benzophenone\n\nScientists in the US National Toxicology Program routinely evaluate existing and new chemicals for potential human toxicity. These evaluations involve a variety of test paradigms, ranging from high-throughput *in vitro* tests to animal bioassays. A study of benzophenone, which has many uses ranging from producing \"sweet-woody-geranium-like notes\" in perfume to preventing UV damage to other chemicals, involved 150 female rats exposed to various doses of benzophenone and 50 unexposed (control) rats. The outcome of interest to us is a particular tumor, histiocytic sarcoma.\n\n## \n\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\ntumordat <- data.frame(\n  \"tumor_no\" = c(147, 50),\n  \"tumor_yes\" = c(3, 0),\n  row.names = c(\"Exposed\", \"Control\"),\n  stringsAsFactors = FALSE\n)\ncolnames(tumordat) <- c(\"No Tumor\", \"Tumor\")\n\ntumordat\n```\n````\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        No Tumor Tumor\nExposed      147     3\nControl       50     0\n```\n\n\n:::\n:::\n\n\n\n## Histiocytic Sarcoma\n\nA typical analysis of these data might be use of Fisher's exact test to evaluate whether there is an association between benzophenone exposure and tumor development. We use this test to evaluate the hypothesis.\n\n## Histiocytic Sarcoma\n\n::: panel-tabset\n## Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfisher.test(tumordat)\n```\n:::\n\n\n\n## Results\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tFisher's Exact Test for Count Data\n\ndata:  tumordat\np-value = 0.5746\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 0.000000 7.302064\nsample estimates:\nodds ratio \n         0 \n```\n\n\n:::\n:::\n\n\n\nHere we see a large p-value, indicating that assuming there is no difference in tumor rates between the groups, our data, or data that are more extreme, are not unlikely.\n:::\n\n## Unusual Results\n\nScientists in the National Toxicology Program saw the results quite differently. Histiocytic sarcomas are exceedingly rare. One researcher pointed out that across 6 prior studies involving 460 female rats, no animals in the control groups ever developed this type of tumor.\n\n## Incorporating Historical Data\n\nBayesian methods give us a great mechanism for incorporating historical data into an analysis!\n\nRecall the beta-binomial model: let $\\pi \\sim \\text{Beta}(\\alpha, \\beta)$ and $Y|n \\sim \\text{Bin}(n,\\pi)$. Then $\\pi|y \\sim \\text{Beta}(\\alpha +y, \\beta+n-y)$, and $\\alpha$ and $\\beta$ can be interpreted as the prior number of successes (here, tumors) and failures, respectively.\n\nWe can think of a beta-binomial model for each group, the control group and the benzophenone group.\n\n## Benzophenone Group\n\nGiven that we don't know much about this chemical, we may want to specify a uniform prior, such as a Beta(1,1).\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](3-dis-cases-bayes-stem_files/figure-revealjs/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n\n## Control Group\n\nWe have historical data from prior studies that indicates that of 460 female rats on control, 0 have developed tumors. Because the parameters of the beta distribution must be positive, we can specify a Beta(0.1,460) prior in this group, plotted below.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](3-dis-cases-bayes-stem_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n\nThat's hard to see!\n\n## Zooming In\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](3-dis-cases-bayes-stem_files/figure-revealjs/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n\n\nMost of the prior mass is very close to zero (mean $\\frac{\\alpha}{\\beta}=\\frac{0.1}{460+0.1}=0.0002$).\n\n## Posterior Distributions\n\n::: panel-tabset\n## Benzophenone group\n\n::: columns\n\n::: {.column width=\"40%\"}\nBeta(1,1) prior with 3 successes and 147 failures yields a Beta(1+3,1+147)=Beta(4,148) posterior, and the posterior mean estimate of the probability of a tumor in this group is $\\frac{4}{148+4}=\\frac{4}{152}=0.026$.\n:::\n\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](3-dis-cases-bayes-stem_files/figure-revealjs/unnamed-chunk-7-1.png){width=480}\n:::\n:::\n\n\n:::\n:::\n\n\n## Control group\n\n::: columns\n\n::: {.column width=\"50%\"}\nBeta(0.1,460) prior with 0 successes and 50 failures yields a Beta(0.1+0,460+50)=Beta(0.1,510) posterior, and the posterior mean estimate of the probability of a tumor in this group is $\\frac{0.1}{510.1}=0.0002$.\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](3-dis-cases-bayes-stem_files/figure-revealjs/unnamed-chunk-8-1.png){width=480}\n:::\n:::\n\n\n:::\n:::\n\n:::\n\n## Simulation-Based Inference\n\nWe can evaluate the hypothesis that the posterior mean tumor rate in the benzophenone group is greater than that in the control group by simulating values of the proportions from the respective beta posteriors and counting how many times we see a greater tumor proportion parameter value in the benzophenone group than among controls.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx_con=rbeta(10000000,0.1,510)\nx_ben=rbeta(10000000,4,148)\nmean(x_ben>x_con)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9999041\n```\n\n\n:::\n:::\n\n\n\n## What Ideas Do You Have?\n\n-   Take 5 minutes to consider an example involving Bayesian inference that you might use in one of your courses (tomorrow we will design a posterior analysis activity, so you might think about examples that work well for that goal)\n\n-   Split into (new!) groups of 3-4 and share your ideas\n\n-   Add your examples to [https://bit.ly/3JOBKxp](https://bit.ly/3JOBKxp)\n\n\n-   Assign a reporter for large group sharing",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}